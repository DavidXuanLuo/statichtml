<!doctype html><html lang="zh-CN"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>预测市场多平台日度总值趋势</title><style>:root{--bg:#f6f7fb;--card:#fff;--text:#111827;--muted:#6b7280;--border:#e5e7eb}body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'PingFang SC','Noto Sans CJK SC',sans-serif}.wrap{max-width:1100px;margin:0 auto;padding:14px}.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px;margin:10px 0}h1{font-size:20px;margin:4px 0 8px}.meta{font-size:12px;color:var(--muted);margin-bottom:10px}.legend{display:flex;gap:10px;flex-wrap:wrap;font-size:12px;color:#374151;margin-bottom:8px}.dot{display:inline-block;width:10px;height:10px;border-radius:99px;margin-right:4px;vertical-align:middle}canvas{width:100%;height:280px;display:block;background:#fff;border-radius:8px}table{width:100%;border-collapse:collapse;font-size:12px}th,td{border-bottom:1px solid #eef0f3;padding:7px 6px;text-align:right;vertical-align:top}th:first-child,td:first-child{text-align:left;white-space:nowrap}.null{color:#9ca3af}.left{text-align:left}</style></head><body><div class="wrap"><h1>预测市场多平台日度总值趋势（近90天）</h1><div id="meta" class="meta">加载中…</div><section class="card"><div class="legend"><span><i class="dot" style="background:#2563eb"></i>Polymarket</span><span><i class="dot" style="background:#16a34a"></i>Manifold</span><span><i class="dot" style="background:#7c3aed"></i>Kalshi（T+1公开日度）</span></div><canvas id="chart" width="1060" height="280"></canvas></section><section class="card"><h3 style="margin:0 0 8px;font-size:15px">明细（按日期×平台）</h3><div style="overflow:auto"><table><thead><tr><th>date</th><th>platform</th><th>daily_total_value</th><th>unit</th><th>status</th><th class="left">method</th></tr></thead><tbody id="tbody"></tbody></table></div></section></div><script>(async function(){const res=await fetch('./data/prediction-markets-daily-history.json?_='+Date.now());const data=await res.json();const priority={Kalshi:0,Polymarket:1,Manifold:2};
const rows=(data.records||[]).slice().sort((a,b)=>{
  if(a.date!==b.date) return a.date.localeCompare(b.date);
  return (priority[a.platform]??9)-(priority[b.platform]??9);
});
const validRows=rows.filter(r=>r.daily_total_value!=null && r.daily_total_value!=='' && Number.isFinite(Number(r.daily_total_value)));const byDate={};for(const r of rows){if(!byDate[r.date])byDate[r.date]={Polymarket:null,Manifold:null,Kalshi:null};byDate[r.date][r.platform]=r.daily_total_value;}const labels=Object.keys(byDate).sort();const p=labels.map(d=>byDate[d].Polymarket),m=labels.map(d=>byDate[d].Manifold),k=labels.map(d=>byDate[d].Kalshi);function draw(c,series,colors,labels){const ctx=c.getContext('2d'),W=c.width,H=c.height,pad={l:42,r:12,t:12,b:24};ctx.clearRect(0,0,W,H);const all=series.flat().filter(v=>v!=null),min=all.length?Math.min(...all):0,max=all.length?Math.max(...all):1,yMin=min===max?0:min,yMax=min===max?max*1.1:max*1.1;ctx.strokeStyle='#e5e7eb';for(let i=0;i<4;i++){const y=pad.t+(H-pad.t-pad.b)*i/3;ctx.beginPath();ctx.moveTo(pad.l,y);ctx.lineTo(W-pad.r,y);ctx.stroke();}const n=labels.length,x=i=>pad.l+(W-pad.l-pad.r)*(n<=1?0:i/(n-1)),y=v=>pad.t+(H-pad.t-pad.b)*(1-(v-yMin)/(yMax-yMin||1));ctx.fillStyle='#6b7280';ctx.font='11px sans-serif';labels.forEach((lb,i)=>{if(i===0||i===n-1||i%7===0)ctx.fillText(lb.slice(5),x(i)-12,H-6)});series.forEach((arr,si)=>{ctx.strokeStyle=colors[si];ctx.lineWidth=2;let st=false;ctx.beginPath();arr.forEach((v,i)=>{if(v==null){st=false;return;}const px=x(i),py=y(v);if(!st){ctx.moveTo(px,py);st=true}else ctx.lineTo(px,py)});ctx.stroke();arr.forEach((v,i)=>{if(v==null)return;const px=x(i),py=y(v);ctx.fillStyle=colors[si];ctx.beginPath();ctx.arc(px,py,2.4,0,Math.PI*2);ctx.fill();});});}draw(document.getElementById('chart'),[p,m,k],['#2563eb','#16a34a','#7c3aed'],labels);const fmt=v=>v==null?'<span class="null">null</span>':Number(v).toLocaleString(undefined,{maximumFractionDigits:2});document.getElementById('tbody').innerHTML=validRows.map(r=>`<tr><td>${r.date}</td><td>${r.platform}</td><td>${fmt(r.daily_total_value)}</td><td>${r.unit||''}</td><td>${r.status||''}</td><td class="left">${r.method||''}</td></tr>`).join('');document.getElementById('meta').textContent=`覆盖：${data.coverage.start_date} ~ ${data.coverage.end_date} ｜ 生成：${data.generated_at} ｜ 已隐藏空值行：${rows.length-validRows.length}`;})();</script></body></html>