<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>直播间GMV分页看板</title><style>body{font-family:-apple-system,BlinkMacSystemFont,"PingFang SC";background:#f6f7fb;margin:0}.w{max-width:960px;margin:auto;padding:12px}.tabs{display:flex;gap:8px;margin:8px 0;flex-wrap:wrap}.tab,.btn{border:0;border-radius:999px;padding:8px 14px;background:#e5e7eb}.tab.a,.btn.a{background:#111827;color:#fff}.c{background:#fff;border-radius:12px;padding:12px;margin:10px 0}.k{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}.i{background:#f8fafc;border-radius:8px;padding:8px}.m{color:#6b7280;font-size:12px}table{width:100%;font-size:12px;border-collapse:collapse}td,th{padding:4px;border-bottom:1px solid #eee;text-align:right}td:first-child,th:first-child{text-align:left}.row{display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap}.warn{font-size:12px;color:#b45309}@media(max-width:640px){.k{grid-template-columns:1fr}.tab,.btn{padding:7px 10px;font-size:12px}}</style></head><body><div class="w"><h2 id="title">直播间GMV分页看板</h2><div class="tabs"><button class="tab a" id="t-pop">泡泡玛特</button><button class="tab" id="t-df">东方甄选</button></div><div class="m" id="meta"></div><div class="warn" id="note"></div><div class="c"><div class="k" id="mtd"></div></div><div class="c"><div class="row"><b>按日期分页</b><div><button class="btn" id="prev">上一页</button><button class="btn" id="next">下一页</button></div></div><div class="m" id="pageMeta"></div><div id="daily"></div></div><div class="c" id="rooms"></div></div><script>const S={name:'pop',data:null,page:0,size:7};const f=v=>v==null?'未抓到':(v/1e4).toFixed(2)+'万';function renderHead(d){title.textContent=d.title;meta.textContent=`筛选:${d.meta.time_filter}｜分页:${d.meta.pages_traversed}｜抓取:${d.meta.total_rows_captured||'-'}条｜更新:${d.updated_at}`;note.textContent=d.meta.note?`说明：${d.meta.note}`:'';mtd.innerHTML=`<div class=i><div class=m>累计low</div><b>${f(d.month_to_date_total.low_gmv)}</b></div><div class=i><div class=m>累计estimate</div><b>${f(d.month_to_date_total.estimate_gmv)}</b></div><div class=i><div class=m>累计high</div><b>${f(d.month_to_date_total.high_gmv)}</b></div>`;}function renderPage(){const d=S.data;const all=[...d.days].sort((a,b)=>b.date.localeCompare(a.date));const n=Math.max(1,Math.ceil(all.length/S.size));S.page=Math.max(0,Math.min(S.page,n-1));const seg=all.slice(S.page*S.size,S.page*S.size+S.size);pageMeta.textContent=`第 ${S.page+1}/${n} 页（每页${S.size}天）`;daily.innerHTML=seg.map(x=>`<div class=c><div><b>${x.date}</b>｜总计 ${f(x.total.estimate_gmv)}</div><div class=k>${['low_gmv','estimate_gmv','high_gmv'].map(k=>`<div class=i><div class=m>${k}</div><b>${f(x.total[k])}</b></div>`).join('')}</div></div>`).join('');const rm={};d.rooms.forEach(r=>rm[r]=[]);seg.slice().reverse().forEach(day=>day.rooms.forEach(r=>{if(rm[r.room_name])rm[r.room_name].push({date:day.date,...r})}));rooms.innerHTML=Object.entries(rm).map(([n,arr])=>`<details><summary>${n}</summary><table><tr><th>日期</th><th>low</th><th>est</th><th>high</th></tr>${arr.map(r=>`<tr><td>${r.date}</td><td>${f(r.low_gmv)}</td><td>${f(r.estimate_gmv)}</td><td>${f(r.high_gmv)}</td></tr>`).join('')}</table></details>`).join('');}async function loadPop(){S.data=await (await fetch('./data/popmart-liverooms-2026-02.json')).json();S.page=0;renderHead(S.data);renderPage();tPop.className='tab a';tDf.className='tab';}async function loadDf(){S.data=await (await fetch('./data/dongfangzhenxuan-liverooms-2026-02.json')).json();S.page=0;renderHead(S.data);renderPage();tDf.className='tab a';tPop.className='tab';}tPop.onclick=loadPop;tDf.onclick=loadDf;prev.onclick=()=>{S.page--;renderPage()};next.onclick=()=>{S.page++;renderPage()};loadPop();</script></body></html>