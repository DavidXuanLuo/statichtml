<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>富途/老虎在港交所占比走势（可验证版）</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body{margin:0;background:#f6f8fb;color:#111;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'PingFang SC',Arial,sans-serif}
    .wrap{max-width:820px;margin:0 auto;padding:14px}
    .card{background:#fff;border-radius:12px;padding:14px;margin-bottom:12px;box-shadow:0 2px 10px rgba(0,0,0,.05)}
    h1{font-size:20px;margin:0 0 6px}
    .muted{color:#666;font-size:13px;line-height:1.45}
    .warn{display:inline-block;background:#fff3cd;border:1px solid #ffe69a;color:#7a5c00;border-radius:999px;padding:3px 10px;font-size:12px}
    table{width:100%;border-collapse:collapse;font-size:13px}
    th,td{padding:8px 6px;border-bottom:1px solid #eee;text-align:left;vertical-align:top}
    th{font-weight:600;background:#fafafa}
    code{background:#f3f4f6;padding:1px 4px;border-radius:4px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>富途/老虎在港交所占比走势（先做可验证版本）</h1>
      <div class="warn">当前可验证结论：分母可做，分子（月度港股成交）公开源不足</div>
      <p class="muted">计算定义：<code>share = broker_volume / hkex_total_turnover</code>。<br/>截至 2026-02-12：2025-12 的 HKEX 月总成交可验证；富途/老虎品牌级月度港股成交额在公开可核验源中未直接披露，故占比暂为 N/A。</p>
    </div>

    <div class="card">
      <canvas id="c" height="220"></canvas>
      <p class="muted">注：折线为占比（%）。当前月份因分子缺失显示为空。</p>
    </div>

    <div class="card">
      <table id="t"></table>
    </div>

    <div class="card">
      <strong>周度是否可做</strong>
      <p class="muted">不可做（当前公开可验证源）。原因：公开源未提供富途/老虎“周度港股成交额”可核验序列。替代方案：按月更新。</p>
    </div>

    <div class="card muted">
      数据文件：<code>hk-broker-share-trend.json</code>
    </div>
  </div>

<script>
fetch('./hk-broker-share-trend.json').then(r=>r.json()).then(d=>{
  const rows = d.data;
  const labels = rows.map(x=>x.month);
  const toPct = v => (v==null?null:+(v*100).toFixed(4));
  const futu = rows.map(x=>toPct(x.futu_share));
  const tiger = rows.map(x=>toPct(x.tiger_share));

  new Chart(document.getElementById('c'),{
    type:'line',
    data:{labels,datasets:[
      {label:'富途占比(%)',data:futu,borderColor:'#2563eb',backgroundColor:'#2563eb',spanGaps:false,tension:.25},
      {label:'老虎占比(%)',data:tiger,borderColor:'#dc2626',backgroundColor:'#dc2626',spanGaps:false,tension:.25}
    ]},
    options:{plugins:{legend:{display:true}},scales:{y:{title:{display:true,text:'%'},beginAtZero:true}}}
  });

  const table = document.getElementById('t');
  table.innerHTML = `<tr>
      <th>月份</th><th>HKEX总成交(十亿HKD)</th><th>富途成交</th><th>老虎成交</th><th>富途占比</th><th>老虎占比</th><th>状态</th>
    </tr>` + rows.map(x=>`<tr>
      <td>${x.month}</td>
      <td>${x.hkex_total_turnover ?? 'N/A'}</td>
      <td>${x.futu_broker_volume ?? 'N/A'}</td>
      <td>${x.tiger_broker_volume ?? 'N/A'}</td>
      <td>${x.futu_share==null?'N/A':(x.futu_share*100).toFixed(4)+'%'}</td>
      <td>${x.tiger_share==null?'N/A':(x.tiger_share*100).toFixed(4)+'%'}</td>
      <td>${x.status}</td>
    </tr>`).join('');
});
</script>
</body>
</html>
